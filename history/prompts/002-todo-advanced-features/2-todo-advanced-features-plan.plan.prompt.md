---
id: 2
title: todo-advanced-features-plan
stage: plan
date: 2025-12-30
surface: agent
model: Claude Sonnet 4.5
feature: todo-advanced-features
branch: 002-todo-advanced-features
user: ai-developer
command: /sp.plan
labels: [planning, todo-app, recurring-tasks, due-dates, reminders]
links:
  spec: specs/002-todo-advanced-features/spec.md
  ticket: null
  adr: null
  pr: null
files:
 - specs/002-todo-advanced-features/plan.md
 - specs/002-todo-advanced-features/research.md
 - specs/002-todo-advanced-features/data-model.md
 - specs/002-todo-advanced-features/quickstart.md
 - specs/002-todo-advanced-features/contracts/task-api.yaml
tests:
 - plan.md validated against constitution principles
 - research.md covers key technical areas
 - data-model.md defines extended Task entity
 - contracts/task-api.yaml specifies API changes
---

## Prompt

Read speckit.constitution, speckit.specify-intermediate, and speckit.specify-advanced very carefully.

You have already implemented Basic + Intermediate Level features in the Phase I console Todo app.

Now generate a complete, detailed speckit.plan for adding Advanced Level intelligent features:

1. Recurring Tasks (daily, weekly, monthly, yearly) with auto-generation of next occurrence on completion
2. Due Dates & Time with flexible input (absolute + relative: "tomorrow 3pm", "next monday", "in 2 days")
3. Console-based Time Reminders (alerts for due soon/overdue tasks with beep and visual highlights)

Key Guidelines from Constitution:
- 100% generated by Claude Code
- Maximum reusability for future phases (Phase III MCP tools, Phase V Kafka/Dapr events)
- Clean architecture, separation of concerns
- Prepare recurrence and reminder logic as potential future subagents/skills

Required Plan Structure (use clean Markdown with sections):

1. High-Level Overview
   - How new features integrate with existing code (models.py, todo_manager.py, main.py)
   - Overall flow for recurring tasks and reminders

2. Updated Data Model
   - Exact dataclass extension for Task with new fields (due_date, recurrence, is_recurring_template, recurrence_parent_id)
   - Type hints and defaults

3. Component Breakdown
   - New/updated methods in todo_manager.py (parse_due_date, generate_next_occurrence, check_reminders, etc.)
   - Changes in main.py (CLI prompts, reminder polling loop)
   - Optional new module: utils/date_utils.py or recurrence_utils.py

4. Recurring Tasks Strategy
   - Template vs Instance pattern
   - Supported recurrence patterns and how to calculate next date
   - Flow when marking complete

5. Due Date Parsing Strategy
   - Supported input formats
   - Handling relative dates ("tomorrow", "next friday", "in 3 days")
   - Fallback behavior

6. Reminder System Strategy
   - Non-blocking polling in main loop
   - Alert logic (due soon = within 15 min, overdue)
   - Visual indicators + console beep (\a)
   - Integration with View Tasks

7. CLI/User Experience Enhancements
   - New prompts during Add/Update
   - Enhanced table display with due date column and symbols (‚è∞, ‚ùå, üîÑ)
   - Example user flows

8. Reusability & Future-Proofing
   - How recurrence generation can become MCP tool
   - How reminder check can trigger events in Phase V
   - Date parser as potential reusable skill

9. Risks, Edge Cases & Mitigations
   - Timezone assumptions
   - Invalid date inputs
   - Beep not working on some systems

10. Testing & Demo Recommendations
    - Key scenarios to demonstrate in video

Generate the plan in professional Markdown format. Make it detailed but actionable.

After the plan, automatically suggest: "Next: Break this plan into atomic speckit.tasks for implementation."

## Response snapshot

I have successfully created a comprehensive implementation plan for the advanced todo app features. The plan includes:

1. **Detailed Architecture**: How the new features integrate with existing code (models.py, todo_manager.py, main.py)
2. **Updated Data Model**: Complete Task dataclass extension with due_date, recurrence, is_recurring_template, and recurrence_parent_id fields
3. **Component Breakdown**: New/updated methods in todo_manager.py, changes in main.py, and new utils/date_utils.py module
4. **Recurring Tasks Strategy**: Template vs Instance pattern, supported recurrence patterns, and flow when marking complete
5. **Due Date Parsing Strategy**: Support for multiple input formats, handling relative dates, and fallback behavior
6. **Reminder System Strategy**: Non-blocking polling, alert logic, visual indicators, and integration with View Tasks
7. **CLI Enhancements**: New prompts, enhanced table display, and example user flows
8. **Reusability & Future-Proofing**: How the features can become MCP tools and prepare for event-driven architecture
9. **Risk Mitigation**: Handling of edge cases and potential issues
10. **Testing Recommendations**: Key scenarios and test coverage

The plan is structured with clear separation of concerns, follows the constitution principles, and prepares the codebase for future phases. I've also created supporting artifacts including research.md, data-model.md, quickstart.md, and API contracts.

## Outcome

- ‚úÖ Impact: Created comprehensive implementation plan for advanced todo features with recurring tasks, due dates, and reminders
- üß™ Tests: Plan validated against constitution principles and all required sections completed
- üìÅ Files: Created plan.md, research.md, data-model.md, quickstart.md, and contracts/task-api.yaml
- üîÅ Next prompts: Ready for /sp.tasks to break plan into atomic implementation tasks
- üß† Reflection: Plan follows SDD principles and prepares for future phases with clean architecture

## Evaluation notes (flywheel)

- Failure modes observed: None
- Graders run and results (PASS/FAIL): All constitution checks passed
- Prompt variant (if applicable): N/A
- Next experiment (smallest change to try): Break plan into atomic tasks with /sp.tasks